{% load static %}
{% load i18n %}
{% load login_form %}
{% load pustakalaya_filters %}
{% get_language_info_list for LANGUAGES as languages %}

<!--THis 2 div closing is in the footer page-->
<div class="" style="margin:0px 0px 5px 0px;padding:0px;">

  <div class=""  style="margin:0px;padding:0px;">


{% comment %}
<nav class="navbar navbar-expand-lg navbar-toggleable-lg navbar-box-shadow  p-0 m-0">
    <div class="container-fluid pr-5 pl-5  " >
        <div class="navbar-translate  small-device-size navigation-width-full">
            <a class="navbar-brand " href="/" id="sm-icon-small">
                <img src="{% static 'images/logos/ep_logo.png' %}"
                     height="50px"

                     alt="Pustakalaya">
            </a>
            <button class="navbar-toggler navbar-toggler-right navigation-icon-pull-right-custom" type="button" data-toggle="collapse"
                    data-target="#navigation" aria-controls="navigation-index" aria-expanded="false"
                    aria-label="Toggle navigation">
                <i class="fa fa-2x fa-bars text-primary" aria-hidden="true"></i>
            </button>


        </div>

        <!-- navigation menu -->
        <div class="collapse navbar-collapse  " id="navigation">
            <ul class="navbar-nav  index_tpyo " id="lg-side-space" >

              <li class="nav-item  " id="lg_large_searchbar">
                <div   >
                    <!-- search -->
                    {% include '_partials/search_form.html' %}
                  </div>
              </li>
                <li class="nav-item " style="margin-top:22px;">
                    <a class="nav-link text-black text-primary small-device-small-font nav-item-hover" href="{% url 'about' %}" >
                        {% trans "About" %}
                    </a>
                </li>
                <!--li class="nav-item">
                    <a class="nav-link text-primary" href="/authors">
                        {% trans "Authors" %}
                    </a>
                </li-->
                <li class="nav-item " style="margin-top:22px;">
                    <a class="nav-link text-primary small-device-small-font nav-item-hover"  href="{% url 'help' %}">{% trans "Help" %}</a>
                </li>
                <li class="nav-item  " style="margin-top:22px;">

                    <a class="nav-link text-primary small-device-small-font nav-item-hover" href="{% url 'feedback' %}">{% trans "Feedback" %}</a>
                </li>




                <!-- language selection button -->
                <li class="nav-item small-device-small-font small-device-search-bar " style="margin-top:20px;">


                    <a class="nav-link text-primary nav-item-hover nav-item-hover">
                        <form action="{% url 'set_language' %}" method="post" id="changeLanguageForm" >
                            {% get_current_language as LANGUAGE_CODE %}
                            {% csrf_token %}
                            <!-- Change value to current_url without language -->
                            <input name="next" type="hidden" value="/"/>
                            <!-- don't change the name language -->
                            {% if LANGUAGE_CODE == "en" %}
                                <i class="flag-icon flag-icon-gb"></i>
                            {% else %}
                                <i class="flag-icon flag-icon-{{ LANGUAGE_CODE }}"></i>
                            {% endif %}
                            <select name="language"
                                    class="text-primary"
                                    style="border: none; background:none; outline:none; ">
                                {% get_available_languages as LANGUAGES %}
                                {% for lang in LANGUAGES %}
                                    <option value="{{ lang.0 }}" {% if lang.0 == LANGUAGE_CODE %}
                                            selected="selected"{% endif %}
                                            style="outline:none;"
                                    >
                                        {{ lang.1 }}

                                    </option>
                                {% endfor %}
                            </select>
                        </form>
                    </a>
                </li>


                {% if user.is_authenticated %}

                    <li class="nav-item dropdown small-device-small-font" style="margin-top:22px;">
                        <a class="nav-link dropdown-toggle text-primary text-capitalize nav-item-hover"

                           href="{% if request.user.is_superuser %}/admin/{% else %}/dashboard/{% endif %}"


                           id="navbarDropdownMenuLink"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {{request.user}}
                        </a>

                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="font-size:100%;">
                            <a class="dropdown-item text-primary text-capitalize"
                               href="{% if request.user.is_superuser %}/admin/{% else %}/dashboard/{% endif %}">{% trans "profile" %}</a>
                            <a class="dropdown-item text-primary text-capitalize"
                               href="{% if request.user.is_superuser %}/accounts/logout{% else %}/accounts/logout{% endif %}">{% trans "logout" %}</a>
                            <a class="dropdown-item text-primary text-capitalize"
                               href="{% if request.user.is_superuser %}/admin/{% else %}/dashboard/settings{% endif %}">{% trans "settings" %}</a>
                        </div>
                    </li>
                {% endif %}


               {% if not  user.is_authenticated %}
                    <li class="nav-item dropdown small-device-small-font" style=" margin-top:22px;" >
                        <a href="#" class="nav-link dropdown-toggle text-primary nav-item-hover" data-toggle="dropdown"
                           aria-haspopup="true"
                           aria-expanded="false">
                            <span class="icon-password"></span> Log In
                        </a>
                        {% login_form %}

                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>
{% endcomment %}

<div id="olenavbar">
    <div class="container parent-cont">
        <div class="row">
            <!-- 2 column logo -->
            <div id="logo-cont" class="col-md-3  col-xs-12 col-sm-12">
                <!-- logo get overflow here -->
                
               <a href="/">
                    <img class="logo"
                style="cursor:pointer"
                 src="{% static 'images_new/pustlogo.png' %}" alt="ole logo" />
               </a>
            </div>

            <!-- 4 column search and nav1 -->
            <div class="col-md-5 col-xs-12 col-sm-12 sec-menu-cont">
                <!-- first row -->
                <div class="row">
                    <div class="col-md-12 col-sm-10 col-xs-10">
                        <!-- search bar -->
                         
                        <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
                            <symbol xmlns="http://www.w3.org/2000/svg" id="sbx-icon-search-13" viewBox="0 0 40 40">
                                <path d="M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z"
                                    fill-rule="evenodd" />
                            </symbol>
                            <symbol xmlns="http://www.w3.org/2000/svg" id="sbx-icon-clear-3" viewBox="0 0 20 20">
                                <path d="M8.114 10L.944 2.83 0 1.885 1.886 0l.943.943L10 8.113l7.17-7.17.944-.943L20 1.886l-.943.943-7.17 7.17 7.17 7.17.943.944L18.114 20l-.943-.943-7.17-7.17-7.17 7.17-.944.943L0 18.114l.943-.943L8.113 10z"
                                    fill-rule="evenodd" />
                            </symbol>
                        </svg>

                        <form novalidate="novalidate" 
                        method="GET"
                        action="/search"
                        class="searchbox sbx-custom">
                            <div role="search" class="sbx-google__wrapper"  style="height:35px;">
                              <!-- <button type="button" class="sbx-custom__dd dropdown-btn">
                                  All &#9662;
                              </button>
                              <div class="dropdown-all">
                                <div>E-Book</div>
                                <div>Audios</div>
                                <div>Videos</div>
                              </div> -->

                              
                                <input type="search" name="q" placeholder="Search E-Pustakalaya" autocomplete="off" required="required" class="sbx-custom__input">
                                <button type="submit" title="Submit your search query." class="sbx-custom__submit">
                                    <svg role="img" aria-label="Search">
                                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-search-13"></use>
                                    </svg>
                                </button>
                                <button type="reset" title="Clear the search query." class="sbx-custom__reset">
                                    <svg role="img" aria-label="Reset">
                                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-clear-3"></use>
                                    </svg>
                                </button>
                            </div>
                        </form>
                       

                        <script type="text/javascript">
                            document.querySelector('.searchbox [type="reset"]').addEventListener('click', function () { this.parentNode.querySelector('input').focus(); });
                        </script>

                        
                        <span id="burger-menu">
                          &#9776;
                        </span>

                        <script type="text/javascript">
                            document.querySelector('.searchbox [type="reset"]').addEventListener('click', function () { this.parentNode.querySelector('input').focus(); });
                        </script>

                    </div>
                </div>
                <!-- second row-->
                <div class="row" id="primary-navbar">
                    <div class="col-md-12">
                        <ul id="menu">
                            <li>
                                <a href="/search/?form-filter=&q=">{% trans "TITLES" %}</a>
                            </li>
                            <li>
                                <a href="/authors">{% trans "AUTHOR" %}</a>
                            </li>
                            <li>
                                <a href="#">CATEGORIES &#9662;</a>
                                <ul class="dropdown-items">
                                    <li>
                                        <a href="/community/literatures-and-arts/"><i class="fas fa-book"></i> Literature And Arts</a>
                                    </li>
                                    <li>
                                        <a href="/community/course-materials/"><i class="fas fa-desktop"></i> Course Materials</a>
                                    </li>
                                    <li>
                                        <a href="/community/teaching-materials/"><i class="fas fa-graduation-cap"></i> Teaching Materials</a>
                                    </li>
                            
                                    <li>
                                        <a href="/community/reference-materials/"><i class="fas fa-briefcase"></i> Reference Materials</a>
                                    </li>
                                    <li>
                                        <a href="/community/other-educational-materials/"><i class="fas fa-flask"></i> Other Educational Materials</a>
                                    </li>
                                    <li>
                                        <a href="/community/newspaper-and-magazines/"><i class="fas fa-newspaper"></i> Newspapers & Magazines</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a href='/search/?q=&form-filter={"type":[],"languages":[],"education_levels":["Primary+Level","Secondary+Level"],"communities":[],"collections":[],"keywords":[],"license_type":[]}'>{% trans "LEVEL" %} &#9662;</a>
                                <ul class="dropdown-items">
                                    <li>
                                        <a href='/search/?q=&form-filter={"type":[],"languages":[],"education_levels":["Primary+Level"],"communities":[],"collections":[],"keywords":[],"license_type":[]}'>Primary Level</a>
                                    </li>
                                    <li>
                                        <a href='/search/?q=&form-filter={"type":[],"languages":[],"education_levels":["Secondary+Level"],"communities":[],"collections":[],"keywords":[],"license_type":[]}'>Secondary Level</a>
                                    </li>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- 4 column nav2-->
            <div class="col-md-4 col-xs-12 col-sm-12">
                <ul id="menu" class="secondary-navbar">
                    <li>
                        <a href="{% url 'about' %}">{% trans "About" %}</a>
                    </li>
                    <li>
                        <a href="{% url 'feedback' %}">{% trans "Feedback" %}</a>
                    </li>
                    <li>
                        <a href="{% url 'help' %}">{% trans "Help" %}</a>
                    </li>
                    <!-- language selection section -->
                    <li>



                            <form action="{% url 'set_language' %}" method="post" id="changeLanguageForm" >
                                    {% get_current_language as LANGUAGE_CODE %}
                                    {% csrf_token %}
                                    <!-- Change value to current_url without language -->
                                    <input name="next" type="hidden" value="/"/>
                                    <!-- language value default is english -->
                                    <input type="hidden" name="language" value="en" />
                                    <!-- don't change the name language -->
                                    {% if LANGUAGE_CODE == "en" %}
                                        <!-- <i class="flag-icon flag-icon-gb"></i> -->
                                        <a href="/"><img class="oleflags" src="{% static 'images_new/gb.png' %}" alt="ole logo" /> {% trans "English" %} &#9662;</a>
                                        
                                    {% endif %}

                                    {% if LANGUAGE_CODE == "ne" %}
                                    <!-- <i class="flag-icon flag-icon-gb"></i> -->
                                    <!-- <a href="#"><img class="oleflags" src="{% static 'images_new/gb.png' %}" alt="ole logo" /> English &#9662;</a> -->
                                    <a href="/"><img class="oleflags" src="{% static 'images_new/nepal.png' %}" alt="ole logo" /> {% trans "नेपाली" %}</a>
                                    
                                    {% endif %}


                                   
                                </form>



                        <!-- <a href="#"><img class="oleflags" src="{% static 'images_new/gb.png' %}" alt="ole logo" /> English &#9662;</a> -->

                        <ul class="dropdown-items">
                                {% get_available_languages as LANGUAGES %}
                                {% for lang in LANGUAGES %}
                            <li style="padding-bottom: 5px; padding-top:5px; cursor:pointer;">
                    
                               
                
                                    <!-- detect on click on this a tag and post to server -->
                                    <a
                                    onclick="change_language(this)"
                                    data-lang={{lang.0}}
                                    >
                                        <img class="oleflags" src="{% if lang.0 == "ne" %}
                                        {% static 'images_new/nepal.png' %}
                                        {% endif %}
                                        {% if lang.0 == "en" %}
                                        {% static 'images_new/gb.png' %}
                                        {% endif %}
                                        
                                        
                                        " alt="ole logo" /> 
                                        {{ lang.1 }}
                                    </a>
                                
                                
                            </li>
                            {% endfor %}



                        </ul>
                    </li>
                    <!-- end language selection form -->
                    


                        {% if not  user.is_authenticated %}
                        <li>
                            <a href="#" class="text-white" data-toggle="dropdown"
                               aria-haspopup="true"
                               aria-expanded="false">
                                <span class="icon-password"></span> {% trans "Log In" %} &#9662;
                            </a>
                            {% login_form %}
    
                        </li>
                    {% endif %}


                    {% if user.is_authenticated %}

                    <li>
                        <a class="text-white text-capitalize"
                           href="{% if request.user.is_superuser %}/admin/{% else %}/dashboard/{% endif %}"
                           id="navbarDropdownMenuLink"
                           data-toggle="dropdown" 
                           aria-haspopup="true" 
                           aria-expanded="false">
                            {{request.user}} &#9662;
                        </a>

                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="font-size:100%;">
                            <a class="dropdown-item text-primary text-capitalize"
                               href="{% if request.user.is_superuser %}/admin/{% else %}/dashboard/{% endif %}">{% trans "profile" %}</a>
                            <a class="dropdown-item text-primary text-capitalize"
                               href="{% if request.user.is_superuser %}/accounts/logout{% else %}/accounts/logout{% endif %}">{% trans "logout" %}</a>
                            <a class="dropdown-item text-primary text-capitalize"
                               href="{% if request.user.is_superuser %}/admin/{% else %}/dashboard/settings{% endif %}">{% trans "settings" %}</a>
                        </div>
                    </li>
                {% endif %}
                  
                </ul>
            </div>

        </div>
        <!-- end main row -->
    </div>
    <!-- end container -->

</div>

<!-- script to reload selected country -->
<script>
    // (function () {
    //     // Grab language selection form
    //     var changeLanguageForm = document.getElementById("changeLanguageForm");
    //     // Select language input
    //     var languageInput = changeLanguageForm.elements.language;
    //     // listen change event on select input
    //     languageInput.onchange = function () {
    //         // If there is change submit the form.
    //         changeLanguageForm.submit();
    //     }
    // })();

        (function (window) {

            window.change_language = function (element) {
    
                // get the form. 
                var changeLanguageForm = document.getElementById("changeLanguageForm");

                // Select language input
                var languageInputField = changeLanguageForm.elements.language;

                // User selected language
                var language_Code = element.getAttribute('data-lang') || "en"; // get selected language.

                // set the user selected languge to input field
                languageInputField.setAttribute('value', language_Code);
                // submit the form.
                changeLanguageForm.submit();
            }
        })(window);
    </script>

